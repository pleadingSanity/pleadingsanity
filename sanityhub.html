<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sanity Hub ‚Äì Pleading Sanity</title>

  <!-- SEO & Social Meta -->
  <meta name="description" content="Sanity Hub: Cosmic healing feed for survivors, creators, and mental health warriors. Breathe, scroll, and rise with Pleading Sanity." />
  <meta property="og:title" content="Sanity Hub ‚Äì Pleading Sanity" />
  <meta property="og:description" content="Cosmic mental health, positive feeds, healing audio, and AI support. Breathe and rise with us." />
  <meta property="og:image" content="assets/crying-brain-og.png" />
  <link rel="icon" href="assets/favicon.ico" />
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="css/style.css" />
  <style>
    body {
      background: radial-gradient(ellipse at 50% 120%, #191b3a 0%, #030c1b 85%, #000 100%);
      min-height: 100vh;
      color: #fff;
      font-family: Inter, Arial, sans-serif;
      background-attachment: fixed;
      overflow-x: hidden;
      position: relative;
    }
    .stars {
      position: fixed; width: 100vw; height: 100vh; z-index: 0; left: 0; top: 0; pointer-events: none; overflow: hidden;
    }
    .star { position: absolute; border-radius: 50%; opacity: 0.85; }
    header { position: sticky; top: 0; z-index: 10; background: rgba(0,0,0,0.78); border-bottom: 1.5px solid #00fff0; padding: 13px; text-align: center; }
    nav ul { list-style: none; display: flex; gap: 1.1rem; justify-content: center; margin: 8px 0 0 0; padding: 0; }
    nav a { color: #00fff0; text-decoration: none; font-weight: 700; transition: .2s; padding: 3px 10px; border-radius: 8px;}
    nav a.active, nav a:hover { color: #ff00ff; background: rgba(0,255,240,0.06); }
    main { max-width: 1100px; margin: auto; padding: 26px 12px; z-index: 2; position: relative;}
    .cosmic-hero { text-align: center; margin-bottom: 16px;}
    .cosmic-hero img { width: 90px; filter: drop-shadow(0 0 16px #00fff099); margin-bottom: 7px;}
    h1, h2 { font-family: inherit; letter-spacing: .01em;}
    .slogan { color: #ff00ff; font-weight: 800; font-size: 1.2em; margin-bottom: 0;}
    .motivation { font-size: 1.13em; margin: 13px 0; color: #00fff0;}
    .feed-intro { margin: 1rem auto 1.3rem auto; font-size: 1.13em; background: rgba(0,255,240,0.03); padding: 10px 24px; border-radius: 15px; border-left: 3px solid #00fff0;}
    .feed-item { background: rgba(255,255,255,0.055); border: 1px solid #00fff0; border-radius: 15px; padding: 15px; margin: 24px 0; box-shadow: 0 0 25px #00fff028; animation: fade .44s;}
    .feed-item iframe { width: 100%; aspect-ratio: 16/9; border-radius: 11px; border: none;}
    .meta { display: flex; align-items: center; justify-content: space-between; margin-top: 10px; gap: 10px; flex-wrap: wrap;}
    .meta .title { font-weight: 700; color: #00fff0; font-size: 1.09em;}
    .btn { cursor: pointer; border: 0; border-radius: 8px; padding: .5rem 1.1rem; background: #00fff0; color: #000; font-weight: 900; transition: .17s;}
    .btn:hover { background: #ff00ff; color: #fff; }
    .points { display: inline-block; margin-left: 8px; background: #ff00ff; color: #fff; padding: 3px 10px; border-radius: 12px; font-size: .97em; font-weight: 700;}
    .journal-link { display: inline-block; background: linear-gradient(90deg,#00fff0,#ff00ff); color: #000; font-weight: bold; border-radius: 9px; padding: 6px 20px; text-decoration: none; margin: 13px 0 0; box-shadow: 0 0 14px #00fff0aa;}
    .journal-link:hover { color: #fff; background: #ff00ff; }
    @keyframes fade { from{opacity:0;transform:translateY(12px);} to{opacity:1;transform:translateY(0);} }
    @media(max-width:700px){main{padding:9px}.feed-item{padding:7px}.cosmic-hero img{width:60px}}
  </style>
</head>
<body>
  <canvas class="stars"></canvas>
  <header>
    <h1>üß† Sanity Hub</h1>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a class="active" href="sanityhub.html">Sanity Hub</a></li>
        <li><a href="shop.html">Shop</a></li>
        <li><a href="movement.html">Movement</a></li>
        <li><a href="journal-vault.html">Journal Vault</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <div class="cosmic-hero">
      <img src="assets/crying-brain-og.png" alt="Pleading Sanity Crying Brain Logo" />
      <div class="slogan">Built from the bottom, getting real ones to the top.<br>P.S. It's not over.</div>
      <div class="motivation" id="motivation"></div>
    </div>

    <div class="feed-intro">
      Cosmic healing. Infinite scroll. Real stories, no algorithm. <b>Listen</b> to a frequency, <b>watch</b> a survivor, <b>rise</b> from madness.<br>
      <span class="points" id="points">+0</span>
      <a class="journal-link" href="journal-vault.html">‚úçÔ∏è Journal your story</a>
    </div>

    <section>
      <h2>Infinite, Auto-Updating Cosmic Feed</h2>
      <div id="feed"></div>
    </section>
  </main>

  <!-- Healing Frequencies -->
  <audio id="tone" loop autoplay>
    <source src="assets/audio/432hz.mp3" type="audio/mpeg"/>
    <source src="assets/audio/432hz.ogg" type="audio/ogg"/>
    Your browser does not support the audio element.
  </audio>
  <div style="position:fixed;right:16px;bottom:22px;z-index:20;">
    <button id="muteBtn" class="btn" aria-pressed="false">üîä Mute</button>
  </div>

  <!-- Loader -->
  <div id="loader" style="display:none;position:fixed;inset:0;align-items:center;justify-content:center;background:rgba(0,0,0,.82);z-index:20;">
    <div class="spinner" style="width:54px;height:54px;border-radius:50%;border:3px solid #00fff066;border-top-color:#00fff0;animation:spin 1.3s linear infinite;"></div>
  </div>

  <script>
    // ---- COSMIC STARFIELD ----
    (function cosmicStars(){
      const canvas = document.querySelector('.stars');
      const ctx = canvas.getContext('2d');
      let w = window.innerWidth, h = window.innerHeight;
      let stars = Array.from({length: 130}, () => ({
        x: Math.random()*w,
        y: Math.random()*h,
        r: Math.random()*1.2+0.4,
        dx: (Math.random()-0.5)*0.03,
        dy: (Math.random()-0.5)*0.03,
        o: Math.random()*0.7+0.3
      }));

      function resize(){ w=window.innerWidth; h=window.innerHeight; canvas.width=w; canvas.height=h;}
      window.addEventListener('resize',resize); resize();

      function draw(){
        ctx.clearRect(0,0,w,h);
        for(let s of stars){
          ctx.beginPath();
          ctx.arc(s.x,s.y,s.r,0,2*Math.PI);
          ctx.fillStyle=`rgba(0,255,240,${s.o})`;
          ctx.shadowColor="#ff00ff";
          ctx.shadowBlur=8;
          ctx.fill();
          s.x+=s.dx; s.y+=s.dy;
          if(s.x<0)s.x=w; if(s.x>w)s.x=0;
          if(s.y<0)s.y=h; if(s.y>h)s.y=0;
        }
        requestAnimationFrame(draw);
      }
      draw();
    })();

    // ---- MOTIVATIONAL QUOTES ----
    const quotes = [
      "You don‚Äôt rise by hiding your scars. Show them. That‚Äôs your superpower.",
      "Cosmic healing is rebellion in a world that profits off your pain.",
      "Every survivor is a creator. Tell your story; help someone rise.",
      "You‚Äôre not just surviving ‚Äî you‚Äôre building the next universe.",
      "Every storm you outlive becomes your energy.",
      "You‚Äôre the rarest star in the galaxy. Shine.üí´",
      "Madness is proof you felt too much ‚Äî that‚Äôs the real magic.",
      "P.S. It‚Äôs not over. The best chapters haven‚Äôt started yet."
    ];
    document.getElementById('motivation').textContent = quotes[Math.floor(Math.random()*quotes.length)];

    // ---- POINTS SYSTEM ----
    let points = parseInt(localStorage.getItem('sanity_points') || '0');
    function updatePoints(val) {
      points += val;
      localStorage.setItem('sanity_points', points);
      document.getElementById('points').textContent = `+${points}`;
    }
    document.getElementById('points').textContent = `+${points}`;

    // ---- FEED LOADER (YOUTUBE API, FALLBACK TO BRANDED VIDEOS) ----
    async function loadFeed() {
      document.getElementById('loader').style.display='flex';
      try {
        // Replace with dynamic API if you want
        // const res = await fetch('/.netlify/functions/ytFeed?playlist=PL7C1VriGLDPrAq1Im9t7WQxZcuXlA77DA&limit=8');
        // const data = await res.json();
        // For demo, use real branded videos:
        const data = {
          items: [
            {
              videoId: "I6tNnYjbg3A",
              title: "Built From The Bottom ‚Äî Brand Trailer",
              description: "Our story in one punch: turning pain into power.",
            },
            {
              videoId: "INPx4ypr2Uw",
              title: "Sanity Stories: Survivor Spotlight #1",
              description: "Real voices. Real healing. The first in our series of true survival stories.",
            },
            {
              videoId: "ZXmrmAAN4Kk",
              title: "Cosmic Affirmations ‚Äì Energy Loop",
              description: "Take a cosmic break. Soak up positive energy with our brand affirmations.",
            },
            {
              videoId: "yeYRIQ1cwOg",
              title: "Founder‚Äôs Message: Why ‚ÄòPleading Sanity‚Äô Exists",
              description: "Shane breaks it down. This isn‚Äôt just a site ‚Äî it‚Äôs a new movement.",
            },
            {
              videoId: "tF796w_d0ZY",
              title: "Rise Anthem ‚Äì Original",
              description: "The official anthem for all who rise from madness. Play it loud.",
            },
            {
              videoId: "iKc8jCkaabA",
              title: "Mental Health x MMA ‚Äì How Fighting Saved Me",
              description: "Pain into power, struggle into skill. Your story matters.",
            }
          ]
        };

        const feed = document.getElementById('feed');
        feed.innerHTML = '';
        data.items.forEach(v => {
          const card = document.createElement('div');
          card.className = 'feed-item';
          card.innerHTML = `
            <iframe src="https://www.youtube.com/embed/${v.videoId}" title="${v.title.replace(/"/g,'&quot;')}" allowfullscreen loading="lazy"></iframe>
            <div class="meta">
              <div class="title">${v.title}</div>
              <div>
                <button class="btn" onclick="like(this,true)">üëç Positive</button>
                <button class="btn" onclick="like(this,false)">üëé Negative</button>
              </div>
            </div>
            <div style="margin-top:6px;font-size:1.01em;color:#fff9;">
              ${v.description}
            </div>
          `;
          feed.appendChild(card);
        });
      } catch (err) {
        document.getElementById('feed').innerHTML = 
          `<div style="color:#ff3b5c">‚ö†Ô∏è Error loading feed. <button class="btn" onclick="window.location.reload()">Reload</button></div>`;
      }
      document.getElementById('loader').style.display='none';
    }
    function like(btn, yes=true){
      btn.textContent = yes ? '‚úÖ Liked!' : '‚ùå Not for me';
      btn.style.background = yes ? '#00ff90' : '#ff3b5c';
      btn.style.color = yes ? '#001' : '#fff';
      if (yes) updatePoints(1); else updatePoints(-1);
      setTimeout(()=>{ btn.blur(); }, 400);
    }
    loadFeed();

    // ---- AUDIO CONTROLS ----
    (function(){
      const a = document.getElementById('tone'), m = document.getElementById('muteBtn');
      a.muted = false;
      m.addEventListener('click',()=>{ 
        a.muted = !a.muted; 
        m.textContent = a.muted ? 'üîá Unmute' : 'üîä Mute'; 
        m.setAttribute('aria-pressed', String(!a.muted));
      });
      window.addEventListener('pointerdown', ()=>{ if (a.paused) a.play().catch(()=>{}); }, {once:true});
    })();
  </script>
</body>
</html>