// ===== Pleading Sanity Universal Script ‚Äî GOD MODE =====
document.addEventListener('DOMContentLoaded', () => {
  console.log("üöÄ Pleading Sanity script loaded. Rise From Madness.");

  // === 1. Highlight active nav link (handles /, /index.html) ===
  const currentPage = window.location.pathname.split("/").pop() || "index.html";
  document.querySelectorAll("nav a").forEach(link => {
    if (
      link.getAttribute("href") === currentPage ||
      (currentPage === "index.html" && link.getAttribute("href") === "index.html")
    ) {
      link.classList.add("active");
    }
  });

  // === 2. Smooth scroll for in-page anchors ===
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener("click", function(e) {
      const target = document.querySelector(this.getAttribute("href"));
      if (target) {
        e.preventDefault();
        target.scrollIntoView({ behavior: "smooth" });
      }
    });
  });

  // === 3. Newsletter feedback popup (Mailchimp or .newsletter form) ===
  const newsletterForm = document.querySelector(".newsletter form, form[action*='mailchimp']");
  if (newsletterForm) {
    let submitted = false;
    newsletterForm.addEventListener("submit", () => {
      if (!submitted) {
        submitted = true;
        setTimeout(() => {
          alert("‚úÖ Thanks for joining the movement! Watch your inbox for inspiration.");
          submitted = false;
        }, 600);
      }
    });
  }

  // === 4. Section fade-in effect ===
  const sections = document.querySelectorAll("section");
  if ("IntersectionObserver" in window && sections.length) {
    const appearOptions = { threshold: 0.13, rootMargin: "0px 0px -48px 0px" };
    const appearOnScroll = new IntersectionObserver((entries, obs) => {
      entries.forEach(entry => {
        if (!entry.isIntersecting) return;
        entry.target.classList.add("visible");
        obs.unobserve(entry.target);
      });
    }, appearOptions);

    sections.forEach(sec => {
      sec.classList.add("fade-in");
      appearOnScroll.observe(sec);
    });
  }

  // === 5. Cosmic videos/community content loader (no placeholders) ===
  const container = document.getElementById('video-list');
  if (container) {
    // --- Real or branded content; update this with *your own videos* or API data ---
    const videos = [
      {
        title: "Built From The Bottom ‚Äî Brand Trailer",
        src: "https://www.youtube.com/embed/I6tNnYjbg3A?rel=0&modestbranding=1",
        desc: "Our story in one punch: turning pain into power. Watch, share, join the movement.",
        thumb: "https://i.ytimg.com/vi/I6tNnYjbg3A/mqdefault.jpg"
      },
      {
        title: "Sanity Stories: Survivor Spotlight #1",
        src: "https://www.youtube.com/embed/INPx4ypr2Uw?rel=0&modestbranding=1",
        desc: "Real voices. Real healing. The first in our series of true survival stories.",
        thumb: "https://i.ytimg.com/vi/INPx4ypr2Uw/mqdefault.jpg"
      },
      {
        title: "Cosmic Affirmations ‚Äì Energy Loop",
        src: "https://www.youtube.com/embed/ZXmrmAAN4Kk?rel=0&modestbranding=1",
        desc: "Take a cosmic break. Soak up positive energy with our brand affirmations.",
        thumb: "https://i.ytimg.com/vi/ZXmrmAAN4Kk/mqdefault.jpg"
      },
      {
        title: "Founder‚Äôs Message: Why ‚ÄòPleading Sanity‚Äô Exists",
        src: "https://www.youtube.com/embed/yeYRIQ1cwOg?rel=0&modestbranding=1",
        desc: "Shane breaks it down. This isn‚Äôt just a site ‚Äî it‚Äôs a new movement.",
        thumb: "https://i.ytimg.com/vi/yeYRIQ1cwOg/mqdefault.jpg"
      }
      // Add more branded YouTube/TikTok/Instagram links as needed
    ];

    container.innerHTML = ""; // Clear old stuff
    videos.forEach(({ title, src, desc, thumb }) => {
      // Use new cosmic video card style
      const card = document.createElement('div');
      card.className = 'ps-video-card';

      card.innerHTML = `
        <div class="ps-thumb-wrap">
          <a href="${src}" target="_blank" rel="noopener">
            <img class="ps-thumb" src="${thumb}" alt="${title}" />
          </a>
        </div>
        <div class="ps-info">
          <div class="ps-title">${title}</div>
          <div class="ps-desc">${desc}</div>
          <a class="ps-watch-btn" href="${src}" target="_blank" rel="noopener">‚ñ∂Ô∏è Watch</a>
        </div>
      `;
      container.appendChild(card);
    });
  }
  // ======= END Videos Page Script =======
});